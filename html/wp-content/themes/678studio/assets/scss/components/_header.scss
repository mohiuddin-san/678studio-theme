@use '../base/variables' as v;
@use '../base/mixins' as m;

// Header Component - 統合vw()システム適用（Safari 16.4互換）
.header {
	// 自動スケールシステムを有効化
	@include m.auto-scale;
	overflow: visible; // モバイルナビゲーションが表示できるように

	// Safari 16.4 専用フォールバック - CSS Custom Properties が効かない場合
	@supports not (--css: variables) {
		// Static fallback values for very old Safari versions
		width: 100%;
		max-width: 100vw;
		overflow-x: hidden;
	}

	&__container {
		margin: 0 auto;
		// 統合vw()システムでpadding設定
		padding: m.vw(30) m.vw(40) m.vw(10);
		display: flex;
		align-items: center;
		justify-content: space-between;
		position: relative;
		overflow: visible; // モバイルナビゲーションが表示できるように

		// SP用 - 自動判定vw()でレスポンシブ対応
		@include m.mq(md) {
			padding: m.vw(20) m.vw(20) m.vw(10);
			justify-content: center;
		}
	}

	// デスクトップナビ - スマホで隠す
	&__navigation-desktop {
		display: flex;
		align-items: center;
		justify-content: flex-end;
		gap: m.vw(40); // 統合vw()に変更
		flex: 1;
		overflow: hidden; // 縦横両方のスクロールバーを防ぐ

		@include m.mq(md) {
			display: none;
		}

		// navigationとCTAボタンを横並びに
		.navigation {
			display: flex;
			align-items: center;
			justify-content: flex-end;
			gap: m.vw(40); // 統合vw()に変更
			width: 100%;
		}
	}

	// スマホのハンバーガーボタン
	&__hamburger {
		display: none;

		@include m.mq(md) {
			display: block;
			position: absolute;
			right: m.vw(20); // 自動判定vw()
			top: 50%;
			transform: translateY(-50%);
			width: m.vw(40); // 自動判定vw()
			height: m.vw(40); // 自動判定vw()
			background: none;
			border: none;
			cursor: pointer;
			padding: m.vw(8); // 自動判定vw()
			z-index: 10000; // 最前面に配置
		}
	}

	// ハンバーガーの線
	&__hamburger-line {
		@include m.mq(md) {
			display: block;
			width: m.vw(24); // 自動判定vw()
			height: m.vw(2); // 自動判定vw()
			background: #000;
			margin: m.vw(4) 0; // 自動判定vw()
			transition: 0.3s;
			position: relative;
		}
	}

	// フルスクリーンメニュー（新しい分離システム用）
	&__navigation-mobile {
		display: none;

		&.is-open {
			@include m.mq(md) {
				display: flex;
				position: fixed;
				top: 0;
				left: 0;
				width: 100vw;
				height: 100vh;
				/* Safari 16.4+ support for dvh */
				height: 100dvh;
				background: white;
				z-index: 9999;
				padding: 0;
				overflow-y: auto; // 縦スクロールを許可

				// ナビゲーション全体の高さ制限を除去
				.navigation-mobile {
					min-height: 100vh;
					height: auto;
					width: 100%;
					overflow-y: auto;
				}
			}
		}
	}
}

// Branding Component
.branding {
	&__logo {
		display: block;

		@include m.mq(md) {
			margin: 0 auto;
		}
	}

	&__image {
		height: auto;
		max-height: m.vw(50);  // 統合vw()に変更

		@include m.mq(md) {
			max-height: m.vw(40);  // 自動判定vw()
		}
	}
}

// ×アニメーション - 2本線での×表示
@include m.mq(md) {
	.header.is-open .header__hamburger-line {
		background: #000 !important;
		display: block !important;
		opacity: 1 !important;
		position: absolute !important;
		top: 50% !important;
		left: 0 !important;
		transform-origin: center center !important;
		margin: 0 !important;
	}

	.header.is-open .header__hamburger-line:first-child {
		transform: translateY(-50%) rotate(45deg) !important;
	}

	.header.is-open .header__hamburger-line:last-child {
		transform: translateY(-50%) rotate(-45deg) !important;
	}
}
