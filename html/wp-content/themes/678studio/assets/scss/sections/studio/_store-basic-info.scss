// Store Basic Information Section
// =================================================================

@use '../../base/variables' as v;
@use '../../base/mixins' as m;

.store-basic-info-section {
	background: #fff;
	padding: m.vw(80) 0 m.vw(120);

	@include m.mq(md) {
		display: none;
	}

	&__container {
		width: 100%;
		margin: 0 auto;
		@include m.design-grid(
			$cols: (
				m.vw(215),
				1fr,
				m.vw(80),
			)
		);

		@include m.mq(md) {
			padding: 0 m.vw-sp(20);
		}
	}

	// 縦書きタイトル
	&__vertical-title {
		display: flex;
		flex-direction: row;
		align-items: center;
		gap: m.vw(16);
		align-self: start;
		transform: rotate(90deg);
		transform-origin: left top;
		margin-left: 50%;
		margin-top: m.vw(10);
		position: sticky;
		top: 20vh;
		z-index: 10;

		@include m.mq(md) {
			display: none;
		}
	}

	&__circle {
		font-size: m.vw(5);
		color: #f39556;
		font-weight: 400;
	}

	&__title {
		font-family: 'Noto Sans JP';
		font-size: m.vw(16);
		font-weight: 500;
		color: #3f3f3f;
		margin: 0;
		letter-spacing: 1.6px;
		line-height: 200%;
		text-align: center;
		white-space: nowrap;
	}

	&__title-en {
		font-family: v.$en;
		font-size: m.vw(14);
		color: #666;
		font-weight: 400;
		letter-spacing: 0.05em;
	}

	// メインコンテンツエリア
	&__main {
		// メインコンテナーのスタイル

		@include m.mq(md) {
			display: flex;
			flex-direction: column;
		}
	}

	// 上部ブロック：店舗名と説明文
	&__header {
		margin-bottom: m.vw(60);

		@include m.mq(md) {
			margin-bottom: m.vw-sp(40);
			order: 1;
		}
	}

	// 下部ブロック：詳細情報と画像の2カラムレイアウト
	&__body {
		@include m.design-grid(
			$cols: (
				1fr,
				m.vw(506),
			)
		);
		gap: m.vw(134);
		align-items: start;

		@include m.mq(md) {
			display: flex;
			flex-direction: column;
			gap: m.vw-sp(40);
		}
	}

	// 右カラム：ビジュアル要素
	&__visual {
		position: relative;

		@include m.mq(md) {
			order: 2;
			align-self: center;
		}
	}

	// 店舗名エリア（テンプレート）
	&__store-name {
		display: flex;
		align-items: flex-start; // アイコンを上部に合わせる
		gap: m.vw(20);
		margin-bottom: m.vw(24);

		@include m.mq(md) {
			gap: m.vw-sp(16);
			margin-bottom: m.vw-sp(20);
		}
	}

	&__name-icon {
		width: m.vw(44);
		height: m.vw(44);
		flex-shrink: 0;

		@include m.mq(md) {
			width: m.vw-sp(36);
			height: m.vw-sp(36);
		}
	}

	&__name {
		font-family: 'Noto Sans JP';
		font-size: m.vw(31.25);
		font-weight: 700;
		color: #3f3f3f;
		margin: 0;
		line-height: 35px;
		letter-spacing: 1.563px;

		@include m.mq(md) {
			font-size: m.vw-sp(24);
			line-height: 1.4;
			letter-spacing: 1.2px;
		}
	}

	&__main-name {
		line-height: 1.3;
	}

	&__branch-name {
		line-height: 1.3;
		margin-top: m.vw(8);
		font-size: m.vw(24); // メイン店舗名より小さく（約77%）

		@include m.mq(md) {
			margin-top: m.vw-sp(4);
			font-size: m.vw-sp(18); // モバイルでも小さく（約75%）
		}
	}

	// 説明文
	&__description {
		margin-bottom: m.vw(90);
		padding-left: calc(m.vw(44) + m.vw(20)); // アイコン幅 + gap

		@include m.mq(md) {
			margin-bottom: 0;
			padding-left: 0;
			text-align: center;
		}

		p {
			font-family: 'Noto Sans JP';
			font-size: m.vw(20);
			font-weight: 350;
			line-height: 180%;
			color: #3f3f3f;
			letter-spacing: 1px;
			font-feature-settings: 'palt' on;
			margin: 0;

			@include m.mq(md) {
				font-size: m.vw-sp(16);
				line-height: 180%;
				letter-spacing: 0.8px;
			}
		}
	}

	// 詳細情報リスト
	&__details {
		display: flex;
		flex-direction: column;
		gap: m.vw(16);
		padding-left: calc(m.vw(44) + m.vw(20)); // アイコン幅 + gap

		@include m.mq(md) {
			order: 3;
			gap: m.vw-sp(12);
			padding-left: 0;
			align-items: center;
		}
	}

	&__detail-item {
		display: flex;
		align-items: flex-start;
		gap: m.vw(12);

		@include m.mq(md) {
			align-items: center;
			gap: m.vw-sp(8);
		}
	}

	&__detail-icon {
		width: auto;
		height: m.vw(20);
		max-width: m.vw(20);
		flex-shrink: 0;
		object-fit: contain;
		// テキスト1行目の高さ（line-height: 180% of 20px = 36px）の中央に配置
		// (36px - 20px) / 2 = 8px
		margin-top: m.vw(8);

		@include m.mq(md) {
			height: m.vw-sp(16);
			max-width: m.vw-sp(16);
			margin-top: 0;
		}
	}

	&__detail-text {
		font-family: 'Noto Sans JP';
		font-size: m.vw(20);
		font-weight: 500;
		line-height: 180%;
		color: #3f3f3f;
		letter-spacing: 1px;
		font-feature-settings: 'palt' on;

		a {
			color: inherit;
			text-decoration: none;

			&:hover {
				text-decoration: underline;
			}
		}
	}

	// 画像エリア（元の形状を保ちながら微細なうねうね）
	&__image {
		width: m.vw(506);
		height: m.vw(499);
		flex-shrink: 0;
		aspect-ratio: 506/499;
		border-radius: m.vw(300) m.vw(400);
		overflow: hidden;
		position: relative;
		z-index: 2;

		// 微細なうねうねアニメーション（形状はほぼ維持）
		animation: subtle-wave 12s ease-in-out infinite;
	}

	// 微細なうねうねアニメーション
	@keyframes subtle-wave {
		0% {
			border-radius: m.vw(300) m.vw(400);
		}
		25% {
			border-radius: m.vw(310) m.vw(390);
		}
		50% {
			border-radius: m.vw(290) m.vw(410);
		}
		75% {
			border-radius: m.vw(305) m.vw(395);
		}
		100% {
			border-radius: m.vw(300) m.vw(400);
		}
	}

	&__store-img {
		width: 100%;
		height: 100%;
		object-fit: cover;
		object-position: center;
	}

	// 装飾要素（基本配置）
	&__decorations {
		position: absolute;
		top: 0;
		left: 0;
		right: 0;
		bottom: 0;
		pointer-events: none;
		z-index: 3;
	}

	&__wave-1 {
		position: absolute;
		top: m.vw(67);
		left: m.vw(6);
		width: m.vw(57.09);
		height: m.vw(32.99);
		flex-shrink: 0;

		// 位相差アニメーション - 波の山と谷の位置が変化
		.wave-line-1 {
			animation: wave-phase 6s ease-in-out infinite;
			animation-delay: 0s;
		}

		.wave-line-2 {
			animation: wave-phase 6s ease-in-out infinite;
			animation-delay: 1s; // 1秒遅れて位相をずらす
		}

		.wave-line-3 {
			animation: wave-phase 6s ease-in-out infinite;
			animation-delay: 2s; // 2秒遅れて位相をずらす
		}
	}

	// パターン1: ゆらゆら揺れるアニメーション
	@keyframes wave-sway {
		0%, 100% { transform: rotate(-2deg) scale(1); }
		50% { transform: rotate(2deg) scale(1.02); }
	}

	// パターン2: 上下に浮遊するアニメーション
	@keyframes wave-float {
		0%, 100% { transform: translateY(0px); }
		50% { transform: translateY(-8px); }
	}

	// パターン3: 脈動アニメーション
	@keyframes wave-pulse {
		0%, 100% {
			transform: scale(1);
			opacity: 0.8;
		}
		50% {
			transform: scale(1.05);
			opacity: 1;
		}
	}

	// パターン4: 組み合わせ（現在適用中）
	@keyframes wave-combined {
		0%, 100% {
			transform: translateY(0px) rotate(-1deg) scale(1);
			opacity: 0.85;
		}
		25% {
			transform: translateY(-4px) rotate(0deg) scale(1.01);
			opacity: 0.9;
		}
		75% {
			transform: translateY(-2px) rotate(1deg) scale(1.02);
			opacity: 0.95;
		}
	}

	// NEW: 1本ずつ線が波打つかわいいアニメーション
	@keyframes line-wave {
		0%, 100% {
			transform: scaleY(1);
			opacity: 0.8;
		}
		50% {
			transform: scaleY(1.1);
			opacity: 1;
		}
	}

	// 全体のwave脈動アニメーション（動作確認用）
	@keyframes wave-pulse-whole {
		0%, 100% {
			transform: scale(1);
			opacity: 0.9;
		}
		50% {
			transform: scale(1.05);
			opacity: 1;
		}
	}

	// 波形が流れるアニメーション（旧版）
	@keyframes wave-flow {
		0% {
			stroke-dashoffset: 0;
		}
		100% {
			stroke-dashoffset: 30; // ダッシュが流れる距離
		}
	}

	// 連続した線でうねうね動くアニメーション（新版）
	@keyframes wave-wiggle {
		0%, 100% {
			transform: translateY(0px) scaleY(1);
		}
		25% {
			transform: translateY(-1px) scaleY(1.02);
		}
		50% {
			transform: translateY(1px) scaleY(0.98);
		}
		75% {
			transform: translateY(-0.5px) scaleY(1.01);
		}
	}

	// 波形が上下に反転するアニメーション
	@keyframes wave-flip {
		0%, 100% {
			transform: scaleY(1);
		}
		50% {
			transform: scaleY(-1);
		}
	}

	// 位相差アニメーション - 波の山と谷の位置が微妙にずれる
	@keyframes wave-phase {
		0%, 100% {
			transform: translateX(0px);
		}
		25% {
			transform: translateX(2px);
		}
		50% {
			transform: translateX(-3px);
		}
		75% {
			transform: translateX(1px);
		}
	}

	// 口がちょっと動くアニメーション（位置は変えずにサイズのみ）
	@keyframes mouth-wiggle {
		0%, 100% {
			transform: scale(1);
		}
		25% {
			transform: scale(1.05);
		}
		50% {
			transform: scale(0.98);
		}
		75% {
			transform: scale(1.02);
		}
	}

	// 左右の口用：より控えめなアニメーション（欠けないように）
	@keyframes subtle-mouth-wiggle {
		0%, 100% {
			transform: scale(1);
		}
		25% {
			transform: scale(1.015);
		}
		50% {
			transform: scale(0.99);
		}
		75% {
			transform: scale(1.01);
		}
	}

	&__wave-2 {
		position: absolute;
		bottom: m.vw(-13);
		left: m.vw(208);
		width: m.vw(298);
		height: auto;
		flex-shrink: 0;

		// wave-2の12個の線にも位相差アニメーション
		.wave-2-line-1 { animation: wave-phase 8s ease-in-out infinite; animation-delay: 0s; }
		.wave-2-line-2 { animation: wave-phase 8s ease-in-out infinite; animation-delay: 0.3s; }
		.wave-2-line-3 { animation: wave-phase 8s ease-in-out infinite; animation-delay: 0.6s; }
		.wave-2-line-4 { animation: wave-phase 8s ease-in-out infinite; animation-delay: 0.9s; }
		.wave-2-line-5 { animation: wave-phase 8s ease-in-out infinite; animation-delay: 1.2s; }
		.wave-2-line-6 { animation: wave-phase 8s ease-in-out infinite; animation-delay: 1.5s; }
		.wave-2-line-7 { animation: wave-phase 8s ease-in-out infinite; animation-delay: 1.8s; }
		.wave-2-line-8 { animation: wave-phase 8s ease-in-out infinite; animation-delay: 2.1s; }
		.wave-2-line-9 { animation: wave-phase 8s ease-in-out infinite; animation-delay: 2.4s; }
		.wave-2-line-10 { animation: wave-phase 8s ease-in-out infinite; animation-delay: 2.7s; }
		.wave-2-line-11 { animation: wave-phase 8s ease-in-out infinite; animation-delay: 3s; }
		.wave-2-line-12 { animation: wave-phase 8s ease-in-out infinite; animation-delay: 3.3s; }
	}

	&__logo-illust {
		position: absolute;
		bottom: m.vw(29);
		left: m.vw(434);
		width: m.vw(71);
		height: auto;
		flex-shrink: 0;

		// 口だけがちょっと動くかわいいアニメーション
		.mouth-center {
			animation: mouth-wiggle 4s ease-in-out infinite;
			animation-delay: 0s;
			transform-origin: center;
		}

		.face-left-outline {
			animation: subtle-mouth-wiggle 4s ease-in-out infinite;
			animation-delay: 1s; // 1秒遅れて動く
			transform-origin: center;
		}

		.face-right-outline {
			animation: subtle-mouth-wiggle 4s ease-in-out infinite;
			animation-delay: 2s; // 2秒遅れて動く
			transform-origin: center;
		}
	}
}

// Mobile Layout
.store-basic-info-section-mobile {
	display: none;
	background: #fff;
	padding: m.vw-sp(60) 0 m.vw-sp(120); // 元に戻す
	padding-left: m.vw-sp(20); // 画面左からのパディング
	max-width: 100%;
	// overflow-x: hidden; // 横スクロール強制的に防止 - stickyのため一時的にコメントアウト

	// Sticky動作のために必要
	position: relative; // Sticky要素のコンテイニングブロックとして機能
	min-height: 100vh; // スクロール可能な高さを確保

	@include m.mq(md) {
		display: block;
	}

	&__container {
		padding: 0 m.vw-sp(20);
		padding-left: m.vw-sp(
			20
		); // 縦書きタイトル用のスペース（セクションの左パディングと合わせて合計40px）
		display: flex;
		flex-direction: column;
		position: relative;

		// Sticky動作のために必要な設定
		min-height: 100vh; // 最小高さを設定
		height: auto;
		overflow: visible; // または overflow: auto でテスト
	}

	// Mobile Vertical Title (JavaScript制御)
	&__vertical-title {
		display: flex;
		flex-direction: row;
		align-items: center;
		gap: m.vw-sp(12);
		transform: rotate(90deg) translateX(m.vw-sp(-10));
		transform-origin: left top;
		align-self: flex-start; // Flexbox内でのsticky動作に必要
		margin-left: m.vw-sp(-10);

		// Sticky実装（Safari対応含む）
		position: -webkit-sticky; // Safari用プレフィックス
		position: sticky;
		top: calc(var(--header-height, 12.1052631579vw) + m.vw-sp(75)); // store-nameの位置に合わせて調整
		z-index: 10;
	}

	&__circle {
		font-size: m.vw-sp(4);
		color: #f39556;
		font-weight: 400;
	}

	&__title {
		font-family: 'Noto Sans JP';
		font-size: m.vw-sp(10.24);
		font-weight: 500;
		color: #3f3f3f;
		margin: 0;
		letter-spacing: m.vw-sp(1.024);
		line-height: 200%;
		text-align: center;
		white-space: nowrap;
	}

	&__title-en {
		font-family: v.$en;
		font-size: m.vw-sp(8.5);
		color: #666;
		font-weight: 400;
		letter-spacing: 0.05em;
	}

	// Store Name (Top)
	&__store-name {
		display: flex;
		align-items: flex-start; // アイコンを上部に合わせる
		gap: m.vw-sp(8);
		justify-content: flex-start;
		margin-bottom: m.vw-sp(20);
	}

	&__name-icon {
		width: m.vw-sp(25);
		height: m.vw-sp(25);
		flex-shrink: 0;
	}

	&__name {
		font-family: 'Noto Sans JP';
		font-size: m.vw-sp(20);
		font-weight: 700;
		color: #3f3f3f;
		margin: 0;
		line-height: m.vw-sp(35);
		letter-spacing: m.vw-sp(1);
	}

	&__main-name {
		line-height: 1.3;
	}

	&__branch-name {
		line-height: 1.3;
		margin-top: m.vw-sp(4);
		font-size: m.vw-sp(15); // メイン店舗名より小さく（約75%）
	}

	// Store Description
	&__description {
		text-align: justify;
		margin-bottom: m.vw-sp(40);

		p {
			font-family: 'Noto Sans JP';
			font-size: m.vw-sp(16);
			font-weight: 350;
			line-height: 200%;
			color: #3f3f3f;
			letter-spacing: m.vw-sp(0.8);
			font-feature-settings: 'palt' on;
			margin: 0;
		}
	}

	// Store Image Area (Full Width Wrapper)
	&__image-area {
		position: relative;
		left: calc(-53vw + 50%); // breakout-bgの仕組みを応用
		width: 100vw; // 画面全幅（必要）
		max-width: 100vw; // 最大幅制限
		overflow-x: hidden; // 横スクロール防止
		margin-bottom: m.vw-sp(72); // 下の詳細セクションとの間隔

		// 高さ調整
		height: auto;
		min-height: 0; // 最小高さをリセット
		// overflow設定を削除 - body要素で制御
	}

	// Store Image Container (Image Only)
	&__image-container {
		width: 100%;
		display: flex;
		justify-content: center;
		align-items: center;
		position: relative;
		overflow: hidden; // 縦スクロールを防ぐ
	}

	&__image {
		width: m.vw-sp(398);
		height: m.vw-sp(392);
		flex-shrink: 0;
		aspect-ratio: 199/196;
		border-radius: m.vw-sp(300) m.vw-sp(400);
		overflow: hidden;
		position: relative;
		z-index: 2;

		// モバイル版も微細なうねうねアニメーション
		animation: subtle-wave-mobile 12s ease-in-out infinite;
	}

	// モバイル版微細なうねうねアニメーション
	@keyframes subtle-wave-mobile {
		0% {
			border-radius: m.vw-sp(300) m.vw-sp(400);
		}
		25% {
			border-radius: m.vw-sp(310) m.vw-sp(390);
		}
		50% {
			border-radius: m.vw-sp(290) m.vw-sp(410);
		}
		75% {
			border-radius: m.vw-sp(305) m.vw-sp(395);
		}
		100% {
			border-radius: m.vw-sp(300) m.vw-sp(400);
		}
	}

	&__store-img {
		width: 100%;
		height: 100%;
		object-fit: cover;
		object-position: center;
	}

	// Decorative Elements for Mobile (Independent)
	&__decorations {
		position: absolute;
		top: 0;
		left: 0;
		width: 100%;
		height: auto; // 高さは自動調整
		pointer-events: none;
		z-index: 3;
		// min-heightを削除 - 余計な高さでスクロールバー発生を防ぐ
	}

	&__wave-1 {
		position: absolute;
		top: m.vw-sp(30);
		left: m.vw-sp(40);
		width: m.vw-sp(57.09);
		height: m.vw-sp(32.99);
		flex-shrink: 0;

		// モバイル版も位相差アニメーション - 波の山と谷の位置が変化
		.wave-line-1 {
			animation: wave-phase 6s ease-in-out infinite;
			animation-delay: 0s;
		}

		.wave-line-2 {
			animation: wave-phase 6s ease-in-out infinite;
			animation-delay: 1s; // 1秒遅れて位相をずらす
		}

		.wave-line-3 {
			animation: wave-phase 6s ease-in-out infinite;
			animation-delay: 2s; // 2秒遅れて位相をずらす
		}
	}

	&__wave-2 {
		position: absolute;
		bottom: m.vw-sp(-380); // 少し上に調整してバランスを取る
		right: m.vw-sp(0);
		width: m.vw-sp(120);
		height: auto;
		// overflow設定を削除

		// とりあえず全体的なゆらゆらアニメーション
		animation: wave-float 8s ease-in-out infinite;
	}

	&__logo-illust {
		position: absolute;
		bottom: m.vw-sp(20);
		right: m.vw-sp(40);
		width: m.vw-sp(35);
		height: auto;

		// モバイル版も口だけがちょっと動くかわいいアニメーション
		.mouth-center {
			animation: mouth-wiggle 4s ease-in-out infinite;
			animation-delay: 0s;
			transform-origin: center;
		}

		.face-left-outline {
			animation: subtle-mouth-wiggle 4s ease-in-out infinite;
			animation-delay: 1s; // 1秒遅れて動く
			transform-origin: center;
		}

		.face-right-outline {
			animation: subtle-mouth-wiggle 4s ease-in-out infinite;
			animation-delay: 2s; // 2秒遅れて動く
			transform-origin: center;
		}
	}

	// Store Details (Bottom)
	&__details {
		display: flex;
		flex-direction: column;
		gap: m.vw-sp(20);
	}

	&__details-list {
		display: flex;
		flex-direction: column;
		gap: m.vw-sp(16);
		align-items: center;
	}

	&__detail-item {
		display: flex;
		align-items: flex-start;
		gap: m.vw-sp(12);
		justify-content: flex-start;
		width: 100%;
		max-width: m.vw-sp(320);
	}

	&__detail-icon {
		width: auto;
		height: m.vw-sp(15);
		max-width: m.vw-sp(15);
		flex-shrink: 0;
		object-fit: contain;
		// テキスト1行目の高さ（line-height: 180% of 12.9px = 23.22px）の中央に配置
		// (23.22px - 15px) / 2 = 4.11px ≈ 4px
		margin-top: m.vw-sp(4);
	}

	&__detail-text {
		font-family: 'Noto Sans JP';
		font-size: m.vw-sp(12.9);
		font-weight: 500;
		line-height: 180%;
		color: #3f3f3f;
		letter-spacing: m.vw-sp(0.645);
		font-feature-settings: 'palt' on;

		a {
			color: inherit;
			text-decoration: none;

			&:hover {
				text-decoration: underline;
			}
		}
	}
}
